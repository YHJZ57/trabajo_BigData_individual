---
title: "La población de animales de granja en Europa"
description: |
 Un estudio simpre de la demografía ganadera europea
author:
  - name: Yutao Henry Jiang Zheng
    affiliation: Universitat de València
    affiliation-url: https://www.uv.es
date: 2026-01-02                           #--
categories: [trabajo BigData, Animales de granja, Demografía]   #--
image: "Directions Boat"
title-block-banner: "imagenes/Banner_Bovinos.png"
title-block-banner-color: "skyblue3"
toc-depth: 4
smooth-scroll: true
format: 
  html:
    #embed-resources: true
    link-external-newwindow: true
    #css: assets/my_css_file.css   #- CUIDADO!!!!
code-tools: true
code-link: true
---

# 1. Introducción

En este trabajo se analiza la demografía de los animales de granja en Europa, un aspecto fundamental para comprender la estructura y la evolución del sector ganadero en el continente. La población ganadera desempeña un papel clave en la economía europea, en la seguridad alimentaria y en el desarrollo de las zonas rurales.

A través del estudio de las principales especies de animales de granja, entre las que se incluyen el ganado bovino, porcino, ovino y avícola, se pretende examinar su distribución geográfica, su evolución en los últimos años y las diferencias existentes entre los distintas regiones europeas.

# 2. Datos

Para realizar el trabajo utilizaremos los siguientes datos:

::: {.panel-tabset}

## Fuente de los datos
Los datos utilizados en este estudio provienen principalmente de fuentes estadísticas oficiales, concretamente de [Eurostat](https://ec.europa.eu/eurostat/en/?etrans=es){target="_blank"} y del Instituto Nacional de Estadística ([INE](https://ine.es/){target="_blank"})


## Datos usados
- Nº_Bovinos → Número de bovinos por miles de cabezas en Europa
- Nº_Porcinos → Número de porcinos por miles de cabezas en Europa
- Nº_Ovinos → Número de ovinos por miles de cabezas en Europa
- Nº_AvedeCoral → Número de aves de coral por número de cabezas en Europa
- Nº_TotalEU → Número total de animales de granja en Europa
- Nº_BovinosES → Número de bovinos por número de cabezas en España
- Nº_PorcinosES → Número de porcinos por número de cabezas en España
- Nº_OvinosES → Número de ovinos por número de cabezas en España
- Nº_AvedeCoralES → Número de aves de coral por número de cabezas en España
- Nº_TotalES → Número total de animales de granja en España

## Paquetes utilizados

```{r}
#| results: hide 
#| warning: false 
#| message: false
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(scales)
library(dplyr)
library(eurostat)
library(scales)
library(ggthemes)
library(highcharter)
library(sf)
library(rnaturalearth)
library(patchwork)
library(countrycode)           
library(gt)
library(gtExtras)
library(mapSpain)
```


## Codigo de los datos

```{r}
#| results: hide 
#| warning: false 
#| message: false
#Número de bovinos por miles de cabezas en Europa
Nº_bovinos <- eurostat::get_eurostat("apro_mt_lscatl")|>tidyr::separate_wider_delim(col = TIME_PERIOD, names = c("Year","Date"), delim = "-",too_many = "merge")|>filter(month=="M12")

#Número de porcinos por miles de cabezas en Europa
Nº_Porcinos <- eurostat::get_eurostat("apro_mt_lspig")|>tidyr::separate_wider_delim(col = TIME_PERIOD, names = c("Year","Date"), delim = "-",too_many = "merge")|>filter(month=="M12")

#Número de ovinos por miles de cabezas en Europa
Nº_Ovinos <- eurostat::get_eurostat("apro_mt_lssheep")|>tidyr::separate_wider_delim(col = TIME_PERIOD, names = c("Year","Date"), delim = "-",too_many = "merge")|>filter(month=="M12")

#Número de aves de coral por número de cabezas en Europa
Nº_AvedeCoral <- read_csv("./Datos/ef_lsk_poultry_page_linear_2_0.csv")
Nº_AvedeCoral <- Nº_AvedeCoral|> mutate(Miles_Cabeza= OBS_VALUE/1000)|> rename("n_Cabeza"="OBS_VALUE")|> mutate(TIME_PERIOD = as.character(TIME_PERIOD))|> select("geo", "TIME_PERIOD", "freq", "animals", "unit","Miles_Cabeza","n_Cabeza")

#Número total de animales de granja en Europa
Nº_TotalEU <- full_join(Nº_bovinos, Nº_Porcinos, by = c("geo", "Year", "freq", "animals", "month", "unit", "values"))
Nº_TotalEU <-Nº_TotalEU|> full_join(Nº_Ovinos, by = c("geo", "Year", "freq", "animals", "month", "unit", "values"))
Nº_TotalEU <-Nº_TotalEU|> full_join(Nº_AvedeCoral, by = c("geo", "Year"="TIME_PERIOD", "freq", "animals", "unit", "values"="Miles_Cabeza"))
Nº_TotalEU <- Nº_TotalEU|> mutate(A=case_when(animals=="A2000"~"Bovino", animals=="A3100"~"Porcino", animals=="A4100"~"Ovino", animals=="A5000"~"Aves de corral", .default = ""))|> filter(A!="")|> group_by(Year, geo)|>mutate(TotalA=sum(values))|>ungroup()
Nº_TotalEU <- Nº_TotalEU|> mutate(Tipo=case_when(geo%in%c("EU27_2020", "EU28","EU27_2020","EU27_2007","EU25","EU","EU15")~"UE", .default = "Pais"))|> group_by(A,geo)|>mutate(N_animal=sum(values))|>ungroup()

#Número de bovinos por número de cabezas en España
Nº_BovinosES <- rio::import("./Datos/Nº_TotalES.1.csv",encoding = "Latin-1")
Nº_BovinosES <- Nº_BovinosES|> mutate(Total= as.numeric(gsub("\\.", "", Total)))
Nº_BovinosES <- Nº_BovinosES|> tidyr::separate_wider_delim(col = `Especies animales`, names = c("N","Animal"), delim = " ",too_many = "merge")
Nº_BovinosES <- Nº_BovinosES|> tidyr::separate_wider_delim(col = `Comunidades y Ciudades Autónomas`, names = c("Nº","Autonomias"), delim = " ",too_many = "merge",too_few = "align_start")|> mutate(Autonomias=case_when(is.na(Autonomias)~"Total_Nacional",TRUE ~ Autonomias))|> tidyr::separate_wider_delim(col = Provincias, names = c("Nu","Provincias"), delim = " ",too_many = "merge",too_few = "align_start")
Nº_BovinosES <- Nº_BovinosES|> filter(Animal=="Bovinos")|>select(Autonomias, Provincias, Animal, Total)

#Número de porcinos por número de cabezas en España
Nº_PorcinosES <- rio::import("./Datos/Nº_TotalES.1.csv",encoding = "Latin-1")
Nº_PorcinosES <- Nº_PorcinosES|> mutate(Total= as.numeric(gsub("\\.", "", Total)))
Nº_PorcinosES <- Nº_PorcinosES|> tidyr::separate_wider_delim(col = `Especies animales`, names = c("N","Animal"), delim = " ",too_many = "merge")
Nº_PorcinosES <- Nº_PorcinosES|> tidyr::separate_wider_delim(col = `Comunidades y Ciudades Autónomas`, names = c("Nº","Autonomias"), delim = " ",too_many = "merge",too_few = "align_start")|> mutate(Autonomias=case_when(is.na(Autonomias)~"Total_Nacional",TRUE ~ Autonomias))|> tidyr::separate_wider_delim(col = Provincias, names = c("Nu","Provincias"), delim = " ",too_many = "merge",too_few = "align_start")
Nº_PorcinosES <- Nº_PorcinosES|> filter(Animal=="Porcinos")|>select(Autonomias, Provincias, Animal, Total)

#Número de ovinos por número de cabezas en España
Nº_OvinosES <- rio::import("./Datos/Nº_TotalES.1.csv",encoding = "Latin-1")
Nº_OvinosES <- Nº_OvinosES|> mutate(Total= as.numeric(gsub("\\.", "", Total)))
Nº_OvinosES <- Nº_OvinosES|> tidyr::separate_wider_delim(col = `Especies animales`, names = c("N","Animal"), delim = " ",too_many = "merge")
Nº_OvinosES <- Nº_OvinosES|> tidyr::separate_wider_delim(col = `Comunidades y Ciudades Autónomas`, names = c("Nº","Autonomias"), delim = " ",too_many = "merge",too_few = "align_start")|> mutate(Autonomias=case_when(is.na(Autonomias)~"Total_Nacional",TRUE ~ Autonomias))|> tidyr::separate_wider_delim(col = Provincias, names = c("Nu","Provincias"), delim = " ",too_many = "merge",too_few = "align_start")
Nº_OvinosES <- Nº_OvinosES|> filter(Animal=="Ovinos")|>select(Autonomias, Provincias, Animal, Total)

#Número de aves de coral por número de cabezas en España
Nº_AvedeCoralES <- rio::import("./Datos/Nº_TotalES.1.csv",encoding = "Latin-1")
Nº_AvedeCoralES <- Nº_AvedeCoralES|> mutate(Total= as.numeric(gsub("\\.", "", Total)))
Nº_AvedeCoralES <- Nº_AvedeCoralES|> tidyr::separate_wider_delim(col = `Especies animales`, names = c("N","Animal"), delim = " ",too_many = "merge")
Nº_AvedeCoralES <- Nº_AvedeCoralES|> tidyr::separate_wider_delim(col = `Comunidades y Ciudades Autónomas`, names = c("Nº","Autonomias"), delim = " ",too_many = "merge",too_few = "align_start")|> mutate(Autonomias=case_when(is.na(Autonomias)~"Total_Nacional",TRUE ~ Autonomias))|> tidyr::separate_wider_delim(col = Provincias, names = c("Nu","Provincias"), delim = " ",too_many = "merge",too_few = "align_start")
Nº_AvedeCoralES <- Nº_AvedeCoralES|> filter(Animal=="Aves de corral")|>select(Autonomias, Provincias, Animal, Total)

#Número total de animales de granja en España
Nº_TotalES <- rio::import("./Datos/Nº_TotalES.1.csv",encoding = "Latin-1")
Nº_TotalES <- Nº_TotalES|> mutate(Total= as.numeric(gsub("\\.", "", Total)))
Nº_TotalES <- Nº_TotalES|> tidyr::separate_wider_delim(col = `Especies animales`, names = c("N","Animal"), delim = " ",too_many = "merge")
Nº_TotalES <- Nº_TotalES|> tidyr::separate_wider_delim(col = `Comunidades y Ciudades Autónomas`, names = c("Nº","Autonomias"), delim = " ",too_many = "merge",too_few = "align_start")|> mutate(Autonomias=case_when(is.na(Autonomias)~"Total_Nacional",TRUE ~ Autonomias))|> tidyr::separate_wider_delim(col = Provincias, names = c("Nu","Provincias"), delim = " ",too_many = "merge",too_few = "align_start")
Nº_TotalES <- Nº_TotalES|>select(Autonomias, Provincias, Animal, Total)
```

:::

---

# 3. La poblacion de las granjas europeas

Europa históricamente fue una región que dependía en gran medida de la ganadería, ya que una parte importante de su territorio presentaba suelos poco fértiles para la agricultura. Esto derivó en que muchos de los pueblos que la habitaban se dedicaran principalmente a la cría de animales como medio de subsistencia.

En la actualidad, las mejoras en las técnicas de cultivo y la integración en el mercado internacional han provocado un cambio significativo en la forma de vida y en la estructura productiva europea, lo que ha dado lugar a una disminución del número de personas dedicadas a la actividad ganadera. Este proceso ha contribuido a una reducción de la población de animales de granja mamíferos, cuya cría requiere mayores costes y mano de obra, en contraste con el sector de las aves de corral, que ha experimentado un crecimiento.

En las gráficas se puede apreciar que la población de animales de granja en general muestra una tendencia negativa desde el año 2001, con la excepción de las aves de corral, cuya población ha aumentado, reflejando la transformación y el descenso progresivo del sector ganadero tradicional en los últimos años.

::::: columns
::: {.column width="50%"}
```{r}
#| warning: false
#| code-fold: true
Nº_TotalEU1 <- Nº_TotalEU|> filter(A!="Aves de corral", Year>="2000", Year<="2024")|> group_by(Year,geo)|> mutate(TotalA1=sum(values))|>ungroup()
Datos_P.UE <- Nº_TotalEU1|> filter(Tipo=="Pais")|> select(geo,Year,A,TotalA1)
Datos_EU27_2020 <- Nº_TotalEU1|> filter(geo=="EU27_2020")|> select(geo,Year,A,TotalA1, values)


ggplot(Datos_P.UE,aes(x= Year, y= TotalA1, group=geo)) +geom_line(color="gray")+ geom_line(data=Datos_EU27_2020, aes(x=Year, y=TotalA1, colour = "EU27_2020"))+ scale_colour_manual(values = c("EU27_2020" = "blue3"),labels = c("Unión Europea")) + scale_y_continuous(labels = label_comma(accuracy = 1))+theme_bw()+ theme(axis.text.x = element_text(angle = 49, vjust = 1, hjust = 1), plot.background = element_rect(fill = "lightyellow"), plot.caption = element_text(hjust = 0, face = "italic", size = 6),plot.title = element_text(face = "bold"))+labs(title="Evolución de la población de animales de granja \nen Europa (2000-2024)", x="Años",y="Miles de cabezas", colour="Región", caption = "*En esta gráfica solo se incluyen los mamíferos, ya que los datos correspondientes a las aves de corral \nno eran consistentes a lo largo del tiempo.", subtitle = "Datos correspondientes exclusivamente a mamíferos")

```
:::

::: {.column width="50%"}
```{r}
#| warning: false
#| code-fold: true
Nº_TotalEU|> filter(geo=="EU27_2020")|> select(geo,Year,A, values)|> filter(Year>="2007",Year<="2020")|> ggplot(aes(x=Year, y=values, fill= reorder(A, -values), group=reorder(A, -values)))+geom_area()+ theme(axis.text.x = element_text(angle = 49, vjust = 1, hjust = 1))+ labs(title="Evolución de la población de animales de granja \nen Europa (2007-2020)", fill="Animales", x="Años",y="Miles de cabezas")+ theme_bw()+ theme(axis.text.x = element_text(angle = 49, vjust = 1, hjust = 1), plot.background = element_rect(fill = "lightyellow"), plot.caption = element_text(hjust = 0, face = "italic", size = 6),plot.title = element_text(face = "bold"))
```
:::

```{r}
#| warning: false
#| code-fold: true
#| fig-width: 35
#| fig-height: 12

Datos_EU27_2020 <- Datos_EU27_2020|> filter(Year>="2001")
ggplot(data=Datos_EU27_2020, aes(x=Year, y=values, fill= reorder(A, -values), group=reorder(A, -values))) +geom_area()+ scale_y_continuous(labels = label_comma(accuracy = 1))+theme_bw()+ theme( plot.background = element_rect(fill = "lightyellow"),plot.title = element_text(face = "bold", size=30))+labs(title="Evolución de la población de animales de granja desgrosado por tipo de animal \nen Europa (2001-2024)", x="Años",y="Miles de cabezas", colour="Tipo de animal", fill="Tipo de animal")+


ggplot(Datos_EU27_2020, aes(x=Year, y=values, fill= reorder(A, -values), group=reorder(A, -values)))+ geom_col(position = "dodge",alpha = 0.6)+geom_line(aes(colour = reorder(A, -values), group=reorder(A, -values)), size=1 )+geom_point(color="gray57", size = 2)+ scale_y_continuous(labels = label_comma(accuracy = 1))+theme_bw()+ theme(plot.background = element_rect(fill = "lightyellow"),plot.title = element_text(face = "bold", size=30))+labs(title="Evolución de la población de animales de granja desgrosado por tipo de animal \nen Europa (2001-2024)", x="Años",y="Miles de cabezas", colour="Tendencia", fill="Tipo de animal")
```


## 3.1. Distribucion por país

```{r}
#| warning: false
#| code-fold: true
#| fig-width: 10
#| fig-height: 5
Datos_mapaUE <- Nº_TotalEU|> filter(Tipo=="Pais", Year=="2020")|> select(geo,Year,A,TotalA)
Datos_mapaUE1 <- Datos_mapaUE|> filter(A=="Bovino")
mapa_ue <- get_eurostat_geospatial(resolution = "20",nuts_level = "0", year = 2021)
mapaUE1<- mapa_ue|> inner_join(Datos_mapaUE1, by = c("id" = "geo"))

M1 <- ggplot(mapaUE1) + geom_sf(aes(fill = TotalA), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory", high="darkgreen",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Censo ganadero por país (2020)", fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))  

Datos_mapaUE2 <- Datos_P.UE|> filter(Year=="2020")
mapaUE2<- mapa_ue|> inner_join(Datos_mapaUE2, by = c("id" = "geo"))

M2 <- ggplot(mapaUE2) + geom_sf(aes(fill = TotalA1), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory", high="darkgreen", labels = scales::label_comma(big.mark = "."), guide= guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Censo ganadero de animales mamíferos \npor país (2020)", fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

M1+M2
```

La población de animales de granja en Europa se concentra principalmente en Francia, seguida de España, Polonia y Alemania. No obstante, al considerar únicamente a los mamíferos, España destaca como el país con mayor número de animales de granja, debido a su liderazgo en la industria porcina y ovina y su gran relevancia en la bovina en el contienente europeo, lo que la sitúa entre los países con mayor peso ganadero dentro de la Unión Europea, como se puede apreciar en los mapas.

# 4. Distribución de las especies de animales

La especie de animal de granja con mayor número de población son las aves de corral con un 51%, seguidas por los porcinos con un 24%, los bovinos con un 13% y los ovinos con un 11%. Esta distribución se debe, en gran medida, al espacio necesario para su cría.
Las aves de corral y los cerdos requieren menos espacio por individuo, lo que permite una producción más intensiva. En cambio, los bovinos y ovinos necesitan amplias zonas de pastoreo, lo que limita su número. Por este motivo, las aves de corral constituyen el grupo más numeroso, seguidas por el ganado porcino.

```{r}
#| warning: false
#| code-fold: true
#| fig-width: 3 
#| fig-height: 2 
Rosca <- Nº_TotalEU|>filter(geo=="EU27_2020", Year=="2020")|> select(A,Year, N_animal)|> mutate(Suma=sum(N_animal))|>mutate(Porcentaje=N_animal/Suma*100)

hchart(Rosca, "pie", hcaes(x = A, y = N_animal))|>hc_plotOptions(pie = list(dataLabels = list( enabled = TRUE, format = "{point.name}: {point.percentage:.0f}%")))|>hc_title(text = "Distribución porcentual de los animales de granja en la UE (2020)")|> hc_chart(backgroundColor = "#f0f0f0")

```

## 4.1. Animales de granja más común en cada país europeo

El animal de granja más común en la mayoría de los países de Europa son las aves de corral, lo que corrobora lo señalado anteriormente. Si se excluyen las aves de corral, los cerdos se convierten en los animales de granja más frecuentes.
```{r}
#| warning: false
#| code-fold: true
#| fig-width: 10
#| fig-height: 5
Datos_mapaUE3 <- Nº_TotalEU|> filter(Year=="2020",Tipo=="Pais")|> group_by(geo)|> slice_max(values, n = 1)
mapaUE3 <- mapa_ue|> inner_join(Datos_mapaUE3, by = c("id"="geo"))

M3 <- ggplot(mapaUE3) + geom_sf(aes(fill = A), color = "white", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_manual(values = c("Ovino" = "chartreuse","Bovino" ="#30123b","Porcino"="red4", "Aves de corral"="skyblue4"))+ theme_void() + labs(title = "Animal de granja más numeroso por país (2020)", fill="Especie Mayoritaria") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaUE4 <- Nº_TotalEU1|> filter(Year=="2020",Tipo=="Pais")|> group_by(geo)|> slice_max(values, n = 1)
mapaUE4 <- mapa_ue|> inner_join(Datos_mapaUE4, by = c("id"="geo"))

M4 <- ggplot(mapaUE4) + geom_sf(aes(fill = A), color = "white", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_viridis_d(option = "turbo", name = "Especie Mayoritaria") + theme_void() + labs(title = "Animal mamifero de granja más numeroso por país (2020)") + theme(plot.title = element_text(face = "bold", size = 11))

M3+M4
```

## 4.2. Concentración de aves de corral por país

La población de aves de corral en Europa se concentra principalmente en Francia, que ocupa la primera posición en este sector, seguida de Polonia y España. Esta distribución responde a la importancia del sector avícola en estos países, así como a la existencia de modelos productivos altamente especializados y tecnificados.

En el caso de Francia, la avicultura cuenta con una larga tradición y una fuerte implantación territorial, apoyada en una amplia red de explotaciones y en una potente industria agroalimentaria. Polonia, por su parte, ha experimentado un notable crecimiento del sector avícola en las últimas décadas, impulsado por la modernización de sus explotaciones y su competitividad en los mercados europeos. España, aunque con un volumen menor, destaca por el desarrollo de sistemas de producción intensiva y por su integración dentro de una industria agroalimentaria diversificada.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaUE5 <- Nº_TotalEU|> filter(Year=="2020", Tipo=="Pais", A=="Aves de corral")|> select(geo, values)
mapaUE5 <- mapa_ue|> inner_join(Datos_mapaUE5, by = c("id"="geo"))

ggplot(mapaUE5) + geom_sf(aes(fill = values), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory",high="skyblue4",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray89")) + theme_void() + labs(title = "Número de aves de corral por país (2020)",fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaUE5|> slice_max(values, n=5)|> mutate(Pais = countrycode(geo, origin = "eurostat", destination = "country.name"))|> mutate(Rank = row_number())|> rename("Mil.Cabezas"="values")|> mutate(Arc.Banderas = case_when(
    geo == "DE" ~ "Alemania.webp",
    geo == "ES" ~ "España.webp",
    geo == "IT" ~ "Italia.webp",
    geo == "EL" ~ "Grecia.png",
    geo == "IE" ~ "Irlanda.png",
    geo == "FR" ~ "Francia.webp",
    geo == "TR" ~ "Turquia.webp",
    geo == "DK" ~ "Dinamarca.webp",
    geo == "PL" ~ "Polonia.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |>
gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Pais, Mil.Cabezas))|>
  cols_hide(columns = c(geo,Arc.Banderas))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Pais, Mil.Cabezas))|> tab_header(title = "Paises europeos con mayor número de aves de corral (2020)")|> gt_theme_excel()|>
  fmt_number(columns = Mil.Cabezas,sep_mark = ".", dec_mark = ",", decimals = 1)


```

## 4.3. Concentración de bovinos por país

La población de bovinos en Europa se concentra principalmente en Turquía, seguida de Francia y Alemania. Esta distribución se explica por la extensión territorial, la disponibilidad de amplias superficies de pasto y la importancia histórica y económica del sector bovino en estos países.

En el caso de Turquía, el elevado número de bovinos está relacionado con su gran tamaño, la diversidad de sus sistemas productivos y el peso de la ganadería tradicional, tanto para la producción de carne como de leche. Francia destaca por su fuerte especialización en el ganado bovino, especialmente en el de carne, apoyada en extensas zonas rurales y una larga tradición ganadera. Por su parte, Alemania combina una ganadería bovina intensiva y tecnificada con un importante sector lechero, lo que contribuye a su elevada cabaña bovina.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaUE6 <- Nº_bovinos|> filter(Year=="2020", animals=="A2000",  geo!="EU27_2020", month=="M12")|> select(geo, values)
mapaUE6 <- mapa_ue|> inner_join(Datos_mapaUE6, by = c("id"="geo"))

ggplot(mapaUE6) + geom_sf(aes(fill = values), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory",high="#30123b",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray89")) + theme_void() + labs(title = "Número de bovinos por país (2020)", fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaUE6|> slice_max(values, n=5)|> mutate(Pais = countrycode(geo, origin = "eurostat", destination = "country.name"))|> mutate(Rank = row_number())|> rename("Mil.Cabezas"="values")|> mutate(Arc.Banderas = case_when(
    geo == "DE" ~ "Alemania.webp",
    geo == "ES" ~ "España.webp",
    geo == "IT" ~ "Italia.webp",
    geo == "EL" ~ "Grecia.png",
    geo == "IE" ~ "Irlanda.png",
    geo == "FR" ~ "Francia.webp",
    geo == "TR" ~ "Turquia.webp",
    geo == "DK" ~ "Dinamarca.webp",
    geo == "PL" ~ "Polonia.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |>
gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Pais, Mil.Cabezas))|>
  cols_hide(columns = c(geo,Arc.Banderas))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Pais, Mil.Cabezas))|> tab_header(title = "Paises europeos con mayor número de bovinos (2020)")|> gt_theme_excel()|>
  fmt_number(columns = Mil.Cabezas,sep_mark = ".", dec_mark = ",", decimals = 1)

```


## 4.4. Concentración de ovinos por país

La población de ovinos en Europa se concentra principalmente en Turquía, seguida de España y Rumanía. Esta distribución se explica por la extensión territorial, las condiciones climáticas favorables y la importancia histórica de la ganadería ovina en estos países.

En el caso de Turquía, el elevado número de ovinos está vinculado a la presencia de amplias zonas rurales de carácter seco o semiárido, donde este tipo de ganado se adapta mejor que otras especies. España destaca por su larga tradición pastoril y por la existencia de sistemas de ganadería extensiva, especialmente en regiones como Extremadura, Castilla y León y Andalucía. Por su parte, Rumanía mantiene una importante cabaña ovina asociada a su medio rural y a modelos productivos tradicionales, en los que el ovino desempeña un papel clave tanto económico como cultural.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaUE7 <- Nº_Ovinos|> filter(Year=="2020", animals=="A4100",  geo!="EU27_2020")|> select(geo, values)
mapaUE7 <- mapa_ue|> inner_join(Datos_mapaUE7, by = c("id"="geo"))

ggplot(mapaUE7) + geom_sf(aes(fill = values), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory",high="chartreuse",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Número de ovinos por país (2020)", fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaUE7|> slice_max(values, n=5)|> mutate(Pais = countrycode(geo, origin = "eurostat", destination = "country.name"))|> mutate(Rank = row_number())|> rename("Mil.Cabezas"="values")|> mutate(Arc.Banderas = case_when(
    geo == "DE" ~ "Alemania.webp",
    geo == "ES" ~ "España.webp",
    geo == "IT" ~ "Italia.webp",
    geo == "EL" ~ "Grecia.png",
    geo == "IE" ~ "Irlanda.png",
    geo == "FR" ~ "Francia.webp",
    geo == "TR" ~ "Turquia.webp",
    geo == "DK" ~ "Dinamarca.webp",
    geo == "PL" ~ "Polonia.png",
    geo == "RO" ~ "Rumania.webp",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |>
gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Pais, Mil.Cabezas))|>
  cols_hide(columns = c(geo,Arc.Banderas))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Pais, Mil.Cabezas))|> tab_header(title = "Paises europeos con mayor número de ovinos (2020)")|> gt_theme_excel()|>
  fmt_number(columns = Mil.Cabezas,sep_mark = ".", dec_mark = ",", decimals = 1)
```

## 4.5. Concentración de porcino por país

La población de porcinos en Europa se concentra principalmente en España, seguida de Alemania y Francia. Esta distribución responde a la especialización productiva de estos países, así como al desarrollo de modelos de ganadería intensiva altamente tecnificados.

España destaca como principal productor porcino europeo gracias a la fuerte integración del sector, la existencia de una potente industria cárnica, unos costes de producción competitivos y una clara orientación exportadora, especialmente hacia otros países de la Unión Europea y mercados internacionales. Alemania, por su parte, ha mantenido históricamente un importante censo porcino apoyado en una industria transformadora consolidada y en una elevada demanda interna. Francia, aunque con un peso menor, continúa siendo un actor relevante gracias a su estructura productiva y a la especialización regional del sector porcino.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaUE8 <- Nº_Porcinos|> filter(Year=="2020", animals=="A3100",  geo!="EU27_2020")|> select(geo, values)
mapaUE8 <- mapa_ue|> inner_join(Datos_mapaUE8, by = c("id"="geo"))

ggplot(mapaUE8) + geom_sf(aes(fill = values), color = "black", linewidth = 0.1) + coord_sf(crs = 3035, xlim = c(2500000, 6500000), ylim = c(1500000, 5200000)) + scale_fill_continuous(low="ivory",high="red4",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray89")) + theme_void() + labs(title = "Número de porcinos por país (2020)", fill="Miles de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaUE8|> slice_max(values, n=5)|> mutate(Pais = countrycode(geo, origin = "eurostat", destination = "country.name"))|> mutate(Rank = row_number())|> rename("Mil.Cabezas"="values")|> mutate(Arc.Banderas = case_when(
    geo == "DE" ~ "Alemania.webp",
    geo == "ES" ~ "España.webp",
    geo == "IT" ~ "Italia.webp",
    geo == "EL" ~ "Grecia.png",
    geo == "IE" ~ "Irlanda.png",
    geo == "FR" ~ "Francia.webp",
    geo == "TR" ~ "Turquia.webp",
    geo == "DK" ~ "Dinamarca.webp",
    geo == "PL" ~ "Polonia.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |>
gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Pais, Mil.Cabezas))|>
  cols_hide(columns = c(geo,Arc.Banderas))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Pais, Mil.Cabezas))|> tab_header(title = "Paises europeos con mayor número de porcinos (2020)")|> gt_theme_excel()|>
  fmt_number(columns = Mil.Cabezas,sep_mark = ".", dec_mark = ",", decimals = 1)

```

# 5. La población de animales de granja en España

España es el segundo país de Europa con mayor poblacion de aninmales de granja esto demuestra la importacia del sector ganadero en el pais ibero que ocupa el 8,3% del PIB español.  
```{r}
#| warning: false
#| code-fold: true

TablaUE <- Nº_TotalEU|> filter(A=="Bovino", Tipo=="Pais", Year=="2020")|>
  mutate(Pais = countrycode(geo, origin = "eurostat", destination = "country.name"))|> slice_max(TotalA, n=5)|>mutate(Rank = row_number())|> rename("Mil.Cabezas"="TotalA")|> mutate(Arc.Banderas = case_when(
    geo == "DE" ~ "Alemania.webp",
    geo == "ES" ~ "España.webp",
    geo == "IT" ~ "Italia.webp",
    geo == "EL" ~ "Grecia.png",
    geo == "IE" ~ "Irlanda.png",
    geo == "FR" ~ "Francia.webp",
    geo == "TR" ~ "Turquia.webp",
    geo == "DK" ~ "Dinamarca.webp",
    geo == "PL" ~ "Polonia.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas))|> select(Rank, url_imagen, Pais, Mil.Cabezas, geo, Arc.Banderas)|> 
  gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Pais, Mil.Cabezas))|>
  cols_hide(columns = c(geo,Arc.Banderas))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Pais, Mil.Cabezas))|> tab_header(title = "Paises europeos con mayor número de animales de granja (2020)")|> gt_theme_excel()|>
  fmt_number(columns = Mil.Cabezas,sep_mark = ".", dec_mark = ",", decimals = 1)

TablaUE
```

## 5.1. Distribución de los animales de granja en el territorio nacional

La población de animales de granja en España se concentra principalmente en Cataluña, que es la comunidad autónoma con mayor número de animales, con aproximadamente un 20 % del total, seguida de Castilla-La Mancha y Castilla y León, ambas con alrededor de un 12 %. Esta distribución se explica por la importante industria cárnica presente en Cataluña y por los extensos campos de las dos Castillas, que han favorecido el desarrollo de la ganadería extensiva y el pastoreo.
```{r}
#| warning: false
#| code-fold: true
#| fig-width: 3 
#| fig-height: 2 

España.CCAA <- Nº_TotalES|> filter(is.na(Provincias))|> group_by(Autonomias)|>
  mutate(TotalA=sum(Total))|>ungroup()

RoscaES1 <- España.CCAA|> filter(Autonomias!="Total_Nacional", Animal=="Ovinos")|> arrange((TotalA))

hchart(RoscaES1, "pie", hcaes(x = Autonomias, y = TotalA))|>
  hc_plotOptions(pie = list(dataLabels = list( enabled = TRUE, format = "{point.name}: {point.percentage:.0f}%")))|>hc_title(text = "Distribución porcentual de los animales de granja en España por CC.AA. (2020)")|> hc_chart(backgroundColor = "#f0f0f0")
```

```{r}
#| warning: false
#| code-fold: true

mapa_ccaa <- esp_get_ccaa()
mapaES <- mapa_ccaa|> left_join(RoscaES1, by = c("ine.ccaa.name"= "Autonomias"))
ggplot(mapaES) + geom_sf(aes(fill = TotalA), color = "black", size = 0.2) + scale_fill_continuous(low="ivory", high="darkgreen",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Censo Ganadero por Comunidad Autónoma (2020)", fill="Nº de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))
```

### 5.1.1. Distribución de las especies de animales de granja en el territorio nacional 

La distribución de las especies de animales de granja en España es similar a la media de la Unión Europea, aunque presenta algunas diferencias relevantes. Destaca especialmente la mayor presencia de aves de corral, que representan aproximadamente un 80 % del total, frente al 51 % de la media europea.

Asimismo, en España la población de ovinos supera a la de bovinos, a diferencia de lo que ocurre en gran parte de Europa. Esta situación se explica, en parte, por las condiciones climáticas más secas del país, que resultan más adecuadas para la cría de ovinos que para la de bovinos, los cuales requieren una mayor disponibilidad de pastos.
```{r}
#| warning: false
#| code-fold: true
#| fig-width: 3 
#| fig-height: 2 

RoscaES2 <- Nº_TotalES|> filter(Autonomias=="Total_Nacional")

hchart(RoscaES2, "pie", hcaes(x = Animal, y = Total))|>
  hc_plotOptions(pie = list(dataLabels = list( enabled = TRUE, format = "{point.name}: {point.percentage:.0f}%")))|>hc_title(text = "Distribución porcentual de los animales de granja en España por especie de animal (2020)")|> hc_chart(backgroundColor = "#f0f0f0")
```

### 5.1.2. Animales de granja más común en cada país europeo

El animal de granja más común en la mayoría de las comunidades autónomas de España son las aves de corral, ya que constituyen la especie que requiere menor espacio y menores costes de producción.

No obstante, existen dos excepciones, Asturias y Cantabria, donde el ganado bovino es el animal de granja más numeroso.
```{r}
#| warning: false
#| code-fold: true
 
Datos_mapaES1 <- Nº_TotalES|> filter(is.na(Provincias), Autonomias!="Total_Nacional")|> group_by(Autonomias)|> slice_max(Total, n = 1)
mapaES1 <- mapa_ccaa|> left_join(Datos_mapaES1, by = c("ine.ccaa.name"= "Autonomias"))
ggplot(mapaES1) + geom_sf(aes(fill = Animal), color = "white", linewidth = 0.1) + scale_fill_manual(values = c("Ovinos" = "chartreuse","Bovinos" ="#30123b","Porcinos"="red4", "Aves de corral"="skyblue4"))+ theme_void() + labs(title = "Animal de granja más numeroso por comunidad autonóma (2020)", fill="Especie Mayoritaria") + theme(plot.title = element_text(face = "bold", size = 11))


```

### 5.1.3. Concentración de aves de corral por Comunidad autonóma

La población de aves de corral en España se concentra especialmente en Cataluña, seguida a mucha distancia por Castilla-La Mancha y Galicia. Esto se debe a que Cataluña cuenta con una de las industrias cárnicas más grandes y especializadas de Europa, que, aunque está principalmente enfocada en el sector porcino, también se ha diversificado a gran escala hacia la industria avícola, aunque en menor medida. 

En cambio, Castilla-La Mancha y Galicia mantienen una presencia relevante de aves de corral, pero generalmente vinculada a modelos productivos de menor escala o de carácter más tradicional, lo que limita su volumen relativo en comparación con el registrado en Cataluña.
```{r}
#| warning: false
#| code-fold: true
 
Datos_mapaES2 <- Nº_AvedeCoralES|> filter(is.na(Provincias), Autonomias!="Total_Nacional")
mapaES2 <- mapa_ccaa|> left_join(Datos_mapaES2, by = c("ine.ccaa.name"= "Autonomias"))

ggplot(mapaES2) + geom_sf(aes(fill = Total), color = "black", linewidth = 0.1) + scale_fill_continuous(low="ivory",high="skyblue4", labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray89")) + theme_void() + labs(title = "Número de aves de corral por CC.AA. (2020)",fill="Nº de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaES2|> ungroup()|> slice_max(Total, n=5)|> mutate(Rank = row_number())|> rename("NºCabezas"="Total")|> mutate(Arc.Banderas = case_when(
    Autonomias == "Galicia" ~ "Galicia.png",
    Autonomias == "Cataluña" ~ "Catalunya.png",
    Autonomias == "Castilla - La Mancha" ~ "CastillaMancha.png",
    Autonomias == "Aragón" ~ "Aragon.png",
    Autonomias == "Castilla y León" ~ "CastillaLeon.png",
    Autonomias == "Andalucía" ~ "Andalucia.png",
    Autonomias == "Extremadura" ~ "Extremadura.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |> 
  gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Autonomias, NºCabezas)) |> cols_hide(columns = c(Provincias,Arc.Banderas,Animal))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Autonomias, NºCabezas))|> tab_header(title = "Comunidades autónomas con mayor número de aves de corral (2020)")|> gt_theme_excel()|> fmt_number(columns = NºCabezas,sep_mark = ".", dec_mark = ",", decimals = 0)
```

### 5.1.4. Concentración de bovinos por Comunidad autonóma

La población de bovinos en España se concentra especialmente en Castilla y León, seguida, a considerable distancia, por Galicia y Extremadura. Esta distribución se explica por la amplia disponibilidad de superficies de pasto, la estructura agraria basada en explotaciones extensivas y la tradición ganadera de estas comunidades.

Castilla y León dispone de extensas áreas rurales y praderas naturales que favorecen la ganadería bovina de carne, mientras que Galicia destaca por su especialización en el bovino lechero, apoyada en un clima más húmedo y una mayor disponibilidad de forraje. Por su parte, Extremadura cuenta con el sistema de dehesas, un entorno idóneo para la cría extensiva de bovinos, que combina el aprovechamiento ganadero con el uso sostenible del territorio.

```{r}
#| warning: false
#| code-fold: true

Datos_mapaES3 <- Nº_BovinosES|> filter(is.na(Provincias), Autonomias!="Total_Nacional")
mapaES3 <- mapa_ccaa|> left_join(Datos_mapaES3, by = c("ine.ccaa.name"= "Autonomias"))

ggplot(mapaES3) + geom_sf(aes(fill = Total), color = "black", linewidth = 0.1) + scale_fill_continuous(low="ivory",high="#30123b",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray89")) + theme_void() + labs(title = "Número de bovinos por país (2020)", fill="Nº de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaES3|> ungroup()|> slice_max(Total, n=5)|> mutate(Rank = row_number())|> rename("NºCabezas"="Total")|> mutate(Arc.Banderas = case_when(
    Autonomias == "Galicia" ~ "Galicia.png",
    Autonomias == "Cataluña" ~ "Catalunya.png",
    Autonomias == "Castilla - La Mancha" ~ "CastillaMancha.png",
    Autonomias == "Aragón" ~ "Aragon.png",
    Autonomias == "Castilla y León" ~ "CastillaLeon.png",
    Autonomias == "Andalucía" ~ "Andalucia.png",
    Autonomias == "Extremadura" ~ "Extremadura.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |> 
  gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Autonomias, NºCabezas)) |> cols_hide(columns = c(Provincias,Arc.Banderas,Animal))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Autonomias, NºCabezas))|> tab_header(title = "Comunidades autónomas con mayor número de bovinos (2020)")|> gt_theme_excel()|> fmt_number(columns = NºCabezas,sep_mark = ".", dec_mark = ",", decimals = 0)
```

### 5.1.5. Concentración de ovinos por Comunidad autonóma

La población de ovinos en España se concentra especialmente en Extremadura, seguida de Castilla y León y Andalucía. Esta distribución se debe principalmente a la disponibilidad de amplias superficies de pastos naturales, a la tradición histórica de la ganadería ovina y a las condiciones climáticas secas, que resultan especialmente favorables para este tipo de ganado.

Extremadura destaca por la presencia de dehesas, un sistema agroganadero ideal para la cría extensiva de ovinos, mientras que Castilla y León y Andalucía cuentan con grandes extensiones de terreno rural y una larga tradición pastoril. Además, el ovino se adapta mejor que otros tipos de ganado a zonas con menor disponibilidad de agua y pastos más pobres, lo que explica su predominio en estas comunidades.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaES4 <- Nº_OvinosES|> filter(is.na(Provincias), Autonomias!="Total_Nacional")
mapaES4 <- mapa_ccaa|> left_join(Datos_mapaES4, by = c("ine.ccaa.name"= "Autonomias"))

ggplot(mapaES4) + geom_sf(aes(fill = Total), color = "black", linewidth = 0.1) + scale_fill_continuous(low="ivory",high="chartreuse",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Número de ovinos por país (2020)", fill="Nº de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaES4|> ungroup()|> slice_max(Total, n=5)|> mutate(Rank = row_number())|> rename("NºCabezas"="Total")|> mutate(Arc.Banderas = case_when(
    Autonomias == "Galicia" ~ "Galicia.png",
    Autonomias == "Cataluña" ~ "Catalunya.png",
    Autonomias == "Castilla - La Mancha" ~ "CastillaMancha.png",
    Autonomias == "Aragón" ~ "Aragon.png",
    Autonomias == "Castilla y León" ~ "CastillaLeon.png",
    Autonomias == "Andalucía" ~ "Andalucia.png",
    Autonomias == "Extremadura" ~ "Extremadura.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |> 
  gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Autonomias, NºCabezas)) |> cols_hide(columns = c(Provincias,Arc.Banderas,Animal))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Autonomias, NºCabezas))|> tab_header(title = "Comunidades autónomas con mayor número de ovinos (2020)")|> gt_theme_excel()|> fmt_number(columns = NºCabezas,sep_mark = ".", dec_mark = ",", decimals = 0)
```

### 5.1.6. Concentración de porcinos por Comunidad autonóma

La población de porcinos en España se concentra principalmente en Cataluña, seguida, a notable distancia, por Castilla y León y Aragón. Esta distribución se explica por el alto grado de industrialización e integración del sector porcino catalán, así como por la presencia de una potente industria cárnica, especializada en la producción y transformación de carne porcina y considerada una de las más relevantes de Europa.

Por su parte, Castilla y León y Aragón han experimentado un crecimiento del sector porcino favorecido por la disponibilidad de suelo rural, unos costes de producción relativamente bajos y la expansión de explotaciones integradas, aunque su peso continúa siendo inferior al de Cataluña.
```{r}
#| warning: false
#| code-fold: true

Datos_mapaES5 <- Nº_PorcinosES|> filter(is.na(Provincias), Autonomias!="Total_Nacional")
mapaES5 <- mapa_ccaa|> left_join(Datos_mapaES5, by = c("ine.ccaa.name"= "Autonomias"))

ggplot(mapaES5) + geom_sf(aes(fill = Total), color = "black", linewidth = 0.1) + scale_fill_continuous(low="ivory",high="red4",labels = scales::label_comma(big.mark = "."), guide = guide_colorbar(frame.colour = "black", ticks.colour = "gray57")) + theme_void() + labs(title = "Número de porcinos por país (2020)", fill="Nº de cabezas") + theme(plot.title = element_text(face = "bold", size = 11))

Datos_mapaES5|> ungroup()|> slice_max(Total, n=5)|> mutate(Rank = row_number())|> rename("NºCabezas"="Total")|> mutate(Arc.Banderas = case_when(
    Autonomias == "Galicia" ~ "Galicia.png",
    Autonomias == "Cataluña" ~ "Catalunya.png",
    Autonomias == "Castilla - La Mancha" ~ "CastillaMancha.png",
    Autonomias == "Aragón" ~ "Aragon.png",
    Autonomias == "Castilla y León" ~ "CastillaLeon.png",
    Autonomias == "Andalucía" ~ "Andalucia.png",
    Autonomias == "Extremadura" ~ "Extremadura.png",
    .default =  ""))|>  mutate(url_imagen = paste0("./imagenes/", Arc.Banderas)) |> 
  gt()|> cols_move_to_start(columns= c(Rank, url_imagen, Autonomias, NºCabezas)) |> cols_hide(columns = c(Provincias,Arc.Banderas,Animal))|> gt_img_rows(columns = url_imagen, height = 20)|> cols_label(url_imagen = "")|> cols_align(align = "center", columns = c(url_imagen, Rank, Autonomias, NºCabezas))|> tab_header(title = "Comunidades autónomas con mayor número de porcino (2020)")|> gt_theme_excel()|> fmt_number(columns = NºCabezas,sep_mark = ".", dec_mark = ",", decimals = 0)
```

# 6. Conclusion
Podemos observar que los distintos países de Europa presentan poblaciones de animales de granja muy variadas, lo que refleja la influencia de múltiples factores. Estas diferencias se explican tanto por condiciones naturales, como el clima, la disponibilidad de pastos y el tipo de suelo, como por factores económicos y productivos, incluyendo el grado de industrialización del sector, la tradición ganadera y la orientación hacia mercados nacionales e internacionales.
En conjunto, estos elementos determinan la distribución y el predominio de ciertas especies en cada país, mostrando cómo el entorno natural y económico condiciona la estructura y el desarrollo de la ganadería europea.

# 7. Bibliografia 

- Eurostat. (2026, January 7). *Home*. European Union. https://ec.europa.eu/eurostat

- Instituto Nacional de Estadística. (2026, January 2). *INE – Instituto Nacional de Estadística*. https://ine.es

- Wikipedia. (s.f.). *Wikipedia, la enciclopedia libre*. Fundación Wikimedia. https://www.wikipedia.org/
